@Test(timeout = 25000)
public void testGracefulFailover() throws Exception {
    try {
        cluster.start();
        cluster.waitForActiveLockHolder(0);
        cluster.getService(1).getZKFCProxy(conf, 5000).gracefulFailover();
        cluster.waitForActiveLockHolder(1);
        cluster.getService(0).getZKFCProxy(conf, 5000).gracefulFailover();
        cluster.waitForActiveLockHolder(0);
        // allow to quiesce
        Thread.sleep(10000);
        assertEquals(0, cluster.getService(0).fenceCount);
        assertEquals(0, cluster.getService(1).fenceCount);
        assertEquals(2, cluster.getService(0).activeTransitionCount);
        assertEquals(1, cluster.getService(1).activeTransitionCount);
    } finally {
        cluster.stop();
    }
}
