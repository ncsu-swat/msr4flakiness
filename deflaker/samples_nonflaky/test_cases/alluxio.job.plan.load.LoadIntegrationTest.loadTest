/**
 * Tests that running the load job will load a file into memory, and that running the job again
 * will not create any tasks.
 */
@Test
public void loadTest() throws Exception {
    // write a file outside of Alluxio
    AlluxioURI filePath = new AlluxioURI(TEST_URI);
    FileOutStream os = mFileSystem.createFile(filePath, CreateFilePOptions.newBuilder().setWriteType(WritePType.THROUGH).build());
    os.write((byte) 0);
    os.write((byte) 1);
    os.close();
    // check the file is completed but not in Alluxio
    URIStatus status = mFileSystem.getStatus(filePath);
    Assert.assertEquals(PersistenceState.PERSISTED.toString(), status.getPersistenceState());
    Assert.assertTrue(status.isCompleted());
    Assert.assertEquals(0, status.getInMemoryPercentage());
    // run the load job
    waitForJobToFinish(mJobMaster.run(new LoadConfig("/test", null)));
    // check the file is fully in memory
    status = mFileSystem.getStatus(filePath);
    Assert.assertEquals(100, status.getInMemoryPercentage());
    // a second load should work too, no worker is selected
    long jobId = mJobMaster.run(new LoadConfig("/test", null));
    Assert.assertTrue(mJobMaster.getStatus(jobId).getChildren().isEmpty());
}
