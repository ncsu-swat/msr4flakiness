@Test
public void pathRestrictions() throws Exception {
    FilterImpl f = FilterImpl.newTestInstance();
    assertEquals("/", f.getPath());
    assertEquals(Filter.PathRestriction.NO_RESTRICTION, f.getPathRestriction());
    f.restrictPath("/test", Filter.PathRestriction.ALL_CHILDREN);
    f.restrictPath("/test2", Filter.PathRestriction.ALL_CHILDREN);
    assertTrue(f.isAlwaysFalse());
    f = FilterImpl.newTestInstance();
    f.restrictPath("/test", Filter.PathRestriction.ALL_CHILDREN);
    assertEquals("/test", f.getPath());
    assertEquals(Filter.PathRestriction.ALL_CHILDREN, f.getPathRestriction());
    f.restrictPath("/test/x", Filter.PathRestriction.DIRECT_CHILDREN);
    assertEquals("/test/x", f.getPath());
    assertEquals(Filter.PathRestriction.DIRECT_CHILDREN, f.getPathRestriction());
    f.restrictPath("/test/x/y", Filter.PathRestriction.PARENT);
    assertEquals("/test/x/y", f.getPath());
    assertEquals(Filter.PathRestriction.PARENT, f.getPathRestriction());
    f = FilterImpl.newTestInstance();
    f.restrictPath("/test", Filter.PathRestriction.DIRECT_CHILDREN);
    f.restrictPath("/test/x/y", Filter.PathRestriction.PARENT);
    assertEquals("/test/x/y", f.getPath());
    assertEquals(Filter.PathRestriction.PARENT, f.getPathRestriction());
    f.restrictPath("/test/y", Filter.PathRestriction.DIRECT_CHILDREN);
    assertTrue(f.isAlwaysFalse());
    f = FilterImpl.newTestInstance();
    f.restrictPath("/test/x/y", Filter.PathRestriction.PARENT);
    f.restrictPath("/test/x", Filter.PathRestriction.EXACT);
    assertEquals("/test/x", f.getPath());
    assertEquals(Filter.PathRestriction.EXACT, f.getPathRestriction());
    f.restrictPath("/test/y", Filter.PathRestriction.EXACT);
    assertTrue(f.isAlwaysFalse());
    f = FilterImpl.newTestInstance();
    f.restrictPath("/test", Filter.PathRestriction.ALL_CHILDREN);
    f.restrictPath("/test", Filter.PathRestriction.PARENT);
    assertTrue(f.isAlwaysFalse());
    f = FilterImpl.newTestInstance();
    f.restrictPath("/test/x", Filter.PathRestriction.PARENT);
    f.restrictPath("/test", Filter.PathRestriction.ALL_CHILDREN);
    assertEquals("/test/x", f.getPath());
    assertEquals(Filter.PathRestriction.PARENT, f.getPathRestriction());
    f.restrictPath("/test/x", Filter.PathRestriction.ALL_CHILDREN);
    assertTrue(f.isAlwaysFalse());
    f = FilterImpl.newTestInstance();
    f.restrictPath("/test", Filter.PathRestriction.ALL_CHILDREN);
    f.restrictPath("/test", Filter.PathRestriction.EXACT);
    assertTrue(f.isAlwaysFalse());
    f = FilterImpl.newTestInstance();
    f.restrictPath("/test", Filter.PathRestriction.DIRECT_CHILDREN);
    f.restrictPath("/test/x", Filter.PathRestriction.EXACT);
    assertEquals("/test/x", f.getPath());
    assertEquals(Filter.PathRestriction.EXACT, f.getPathRestriction());
    f = FilterImpl.newTestInstance();
    f.restrictPath("/test", Filter.PathRestriction.DIRECT_CHILDREN);
    f.restrictPath("/test/x/y", Filter.PathRestriction.EXACT);
    assertTrue(f.isAlwaysFalse());
    f = FilterImpl.newTestInstance();
    f.restrictPath("/test/x", Filter.PathRestriction.PARENT);
    f.restrictPath("/", Filter.PathRestriction.ALL_CHILDREN);
    assertEquals("/test/x", f.getPath());
    assertEquals(Filter.PathRestriction.PARENT, f.getPathRestriction());
    f.restrictPath("/test/y", Filter.PathRestriction.EXACT);
    assertTrue(f.isAlwaysFalse());
    f = FilterImpl.newTestInstance();
    f.restrictPath("/test", Filter.PathRestriction.DIRECT_CHILDREN);
    assertEquals("/test", f.getPath());
    assertEquals(Filter.PathRestriction.DIRECT_CHILDREN, f.getPathRestriction());
    f.restrictPath("/", Filter.PathRestriction.ALL_CHILDREN);
    assertEquals("/test", f.getPath());
    assertEquals(Filter.PathRestriction.DIRECT_CHILDREN, f.getPathRestriction());
    f.restrictPath("/test", Filter.PathRestriction.ALL_CHILDREN);
    assertEquals("/test", f.getPath());
    assertEquals(Filter.PathRestriction.DIRECT_CHILDREN, f.getPathRestriction());
    f.restrictPath("/test/x/y", Filter.PathRestriction.PARENT);
    assertEquals("/test/x/y", f.getPath());
    assertEquals(Filter.PathRestriction.PARENT, f.getPathRestriction());
    f.restrictPath("/test2", Filter.PathRestriction.ALL_CHILDREN);
    assertTrue(f.isAlwaysFalse());
    f = FilterImpl.newTestInstance();
    f.restrictPath("/test/x", Filter.PathRestriction.EXACT);
    assertEquals("/test/x", f.getPath());
    assertEquals(Filter.PathRestriction.EXACT, f.getPathRestriction());
    f.restrictPath("/test", Filter.PathRestriction.ALL_CHILDREN);
    f.restrictPath("/test", Filter.PathRestriction.DIRECT_CHILDREN);
    f.restrictPath("/test/x/y", Filter.PathRestriction.PARENT);
    f.restrictPath("/test/y", Filter.PathRestriction.DIRECT_CHILDREN);
    assertTrue(f.isAlwaysFalse());
    f = FilterImpl.newTestInstance();
    f.restrictPath("/test/x/y", Filter.PathRestriction.PARENT);
    assertEquals("/test/x/y", f.getPath());
    assertEquals(Filter.PathRestriction.PARENT, f.getPathRestriction());
    f.restrictPath("/test/x", Filter.PathRestriction.PARENT);
    assertEquals("/test/x", f.getPath());
    assertEquals(Filter.PathRestriction.PARENT, f.getPathRestriction());
    f.restrictPath("/test", Filter.PathRestriction.ALL_CHILDREN);
    assertEquals("/test/x", f.getPath());
    assertEquals(Filter.PathRestriction.PARENT, f.getPathRestriction());
    f.restrictPath("/test", Filter.PathRestriction.DIRECT_CHILDREN);
    assertEquals("/test/x", f.getPath());
    assertEquals(Filter.PathRestriction.PARENT, f.getPathRestriction());
    f.restrictPath("/test/x", Filter.PathRestriction.PARENT);
    assertEquals("/test/x", f.getPath());
    assertEquals(Filter.PathRestriction.PARENT, f.getPathRestriction());
    f.restrictPath("/test", Filter.PathRestriction.PARENT);
    assertEquals("/test", f.getPath());
    assertEquals(Filter.PathRestriction.PARENT, f.getPathRestriction());
    f.restrictPath("/test2", Filter.PathRestriction.EXACT);
    assertTrue(f.isAlwaysFalse());
}
